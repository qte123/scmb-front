{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url-search-params.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CommonTag from \"../../src/components/CommonTag.vue\";\nimport CommonTable from \"../../src/components/CommonTable.vue\";\nimport CommonForm from \"../../src/components/CommonForm.vue\";\nimport { getUser } from \"../../api/data.js\";\nexport default {\n  name: \"User\",\n  components: {\n    CommonTag: CommonTag,\n    CommonTable: CommonTable,\n    CommonForm: CommonForm\n  },\n  data: function data() {\n    return {\n      isShow: false,\n      tags: [],\n      tableData: [],\n      tableLabel: [{\n        prop: \"username\",\n        label: \"用户名\"\n      }, {\n        prop: \"imgTotal\",\n        label: \"图片上传总数\"\n      }, {\n        prop: \"type\",\n        label: \"用户类型\"\n      }, {\n        prop: \"last_login\",\n        label: \"最近登录时间\",\n        width: 200\n      }, {\n        prop: \"add_date\",\n        label: \"用户注册时间\",\n        width: 200\n      }, {\n        prop: \"modify_date\",\n        label: \"用户信息修改时间\",\n        width: 200\n      }, {\n        prop: \"status\",\n        label: \"账号状态\"\n      }, {\n        prop: \"line\",\n        label: \"用户状态\"\n      }],\n      formLabel: [{\n        model: \"keyword\",\n        label: \"\",\n        type: \"input\"\n      }],\n      operateForm: {\n        type: \"\",\n        status: \"\"\n      },\n      username: \"\",\n      operateFormLabel: [{\n        model: \"type\",\n        label: \"用户类型\",\n        type: \"select\",\n        opts: [{\n          label: \"普通用户\",\n          value: \"普通用户\"\n        }, {\n          label: \"管理员\",\n          value: \"管理员\"\n        }]\n      }, {\n        model: \"status\",\n        label: \"账号状态\",\n        type: \"select\",\n        opts: [{\n          label: \"启用\",\n          value: \"启用\"\n        }, {\n          label: \"停用\",\n          value: \"停用\"\n        }]\n      }],\n      searchForm: {\n        keyword: \"\"\n      }\n    };\n  },\n  methods: {\n    editUser: function editUser(row) {\n      this.isShow = true;\n      this.username = row.username;\n      this.operateForm.type = row.type;\n      this.operateForm.status = row.status;\n    },\n    delUser: function delUser(row) {\n      var _this = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"delete_user\");\n      param.append(\"username\", row.username);\n      this.$confirm(\"此操作将永久删除该用户以及该用户所有的图片,是否继续\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        getUser(param).then(function (res) {\n          var ret = res.data[\"ret\"];\n          var msg = res.data[\"msg\"];\n\n          if (ret === 0) {\n            _this.$message.success(msg);\n          } else {\n            _this.$message.error(msg);\n          }\n\n          _this.getUserList();\n        });\n      }).catch(function () {}); //注意这里，这里是重点！！！;\n    },\n    getTagsList: function getTagsList() {\n      var _this2 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"get_user_type\");\n      getUser(param).then(function (res) {\n        _this2.tags = res.data.retlist;\n      });\n    },\n    getUserList: function getUserList() {\n      var _this3 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"get_user_list\");\n      param.append(\"user_type\", \"\");\n      param.append(\"username\", \"\");\n      getUser(param).then(function (res) {\n        _this3.tableData = res.data.retlist;\n      });\n    },\n    clickMenu: function clickMenu(item) {\n      var _this4 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"get_user_list\");\n      param.append(\"user_type\", item.value);\n      param.append(\"username\", \"\");\n      getUser(param).then(function (res) {\n        _this4.tableData = res.data.retlist;\n      });\n    },\n    getList: function getList(username) {\n      var _this5 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"get_user_list\");\n      param.append(\"user_type\", \"\");\n      param.append(\"username\", username);\n      getUser(param).then(function (res) {\n        _this5.tableData = res.data.retlist;\n      });\n    },\n    confirm: function confirm() {\n      var _this6 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"modify_user\");\n      param.append(\"username\", this.username);\n      param.append(\"type\", this.operateForm.type);\n      param.append(\"status\", this.operateForm.status);\n      getUser(param).then(function (res) {\n        var ret = res.data[\"ret\"];\n        var msg = res.data[\"msg\"];\n\n        if (ret === 0) {\n          _this6.$message.success(msg);\n\n          _this6.isShow = false;\n        } else {\n          _this6.$message.error(msg);\n        }\n\n        _this6.getUserList();\n      });\n    },\n    reset: function reset() {\n      var _this7 = this;\n\n      var param = new URLSearchParams();\n      param.append(\"action\", \"reset_password\");\n      param.append(\"username\", this.username);\n      param.append(\"address\", 'user');\n      param.append(\"code\", '');\n      getUser(param).then(function (res) {\n        var ret = res.data[\"ret\"];\n        var msg = res.data[\"msg\"];\n\n        if (ret === 0) {\n          _this7.$message.success(msg);\n\n          _this7.isShow = false;\n        } else {\n          _this7.$message.error(msg);\n        }\n\n        _this7.getUserList();\n      });\n    }\n  },\n  created: function created() {\n    this.getTagsList();\n    this.getUserList();\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCA;AACA;AACA;AACA;AAEA;AACAA,cADA;AAEAC;AAAAC;AAAAC;AAAAC;AAAA,GAFA;AAGAC,MAHA,kBAGA;AACA;AACAC,mBADA;AAEAC,cAFA;AAGAC,mBAHA;AAIAC,mBACA;AACAC,wBADA;AAEAC;AAFA,OADA,EAKA;AACAD,wBADA;AAEAC;AAFA,OALA,EASA;AACAD,oBADA;AAEAC;AAFA,OATA,EAaA;AACAD,0BADA;AAEAC,uBAFA;AAGAC;AAHA,OAbA,EAkBA;AACAF,wBADA;AAEAC,uBAFA;AAGAC;AAHA,OAlBA,EAuBA;AACAF,2BADA;AAEAC,yBAFA;AAGAC;AAHA,OAvBA,EA4BA;AACAF,sBADA;AAEAC;AAFA,OA5BA,EAgCA;AACAD,oBADA;AAEAC;AAFA,OAhCA,CAJA;AAyCAE,kBACA;AACAC,wBADA;AAEAH,iBAFA;AAGAI;AAHA,OADA,CAzCA;AAgDAC;AACAD,gBADA;AAEAE;AAFA,OAhDA;AAoDAC,kBApDA;AAqDAC,yBACA;AACAL,qBADA;AAEAH,qBAFA;AAGAI,sBAHA;AAIAK,eACA;AACAT,uBADA;AAEAU;AAFA,SADA,EAKA;AACAV,sBADA;AAEAU;AAFA,SALA;AAJA,OADA,EAgBA;AACAP,uBADA;AAEAH,qBAFA;AAGAI,sBAHA;AAIAK,eACA;AACAT,qBADA;AAEAU;AAFA,SADA,EAKA;AACAV,qBADA;AAEAU;AAFA,SALA;AAJA,OAhBA,CArDA;AAqFAC;AAAAC;AAAA;AArFA;AAuFA,GA3FA;AA4FAC;AACAC,YADA,oBACAC,GADA,EACA;AACA;AACA;AACA;AACA;AACA,KANA;AAOAC,WAPA,mBAOAD,GAPA,EAOA;AAAA;;AACA;AACAE;AACAA;AACA;AACAC,+BADA;AAEAC,8BAFA;AAGAf;AAHA,SAIAgB,IAJA,CAIA;AACAC;AACA;AACA;;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;;AACA;AACA,SATA;AAUA,OAfA,EAeAC,KAfA,CAeA,cAfA,EAJA,CAmBA;AACA,KA3BA;AA4BAC,eA5BA,yBA4BA;AAAA;;AACA;AACAN;AACAI;AACA;AACA,OAFA;AAGA,KAlCA;AAmCAG,eAnCA,yBAmCA;AAAA;;AACA;AACAP;AACAA;AACAA;AACAI;AACA;AACA,OAFA;AAGA,KA3CA;AA4CAI,aA5CA,qBA4CAC,IA5CA,EA4CA;AAAA;;AACA;AACAT;AACAA;AACAA;AACAI;AACA;AACA,OAFA;AAGA,KApDA;AAqDAM,WArDA,mBAqDApB,QArDA,EAqDA;AAAA;;AACA;AACAU;AACAA;AACAA;AACAI;AACA;AACA,OAFA;AAGA,KA7DA;AA8DAO,WA9DA,qBA8DA;AAAA;;AACA;AACAX;AACAA;AACAA;AACAA;AACAI;AACA;AACA;;AACA;AACA;;AACA;AACA,SAHA,MAGA;AACA;AACA;;AACA;AACA,OAVA;AAWA,KA/EA;AAgFAQ,SAhFA,mBAgFA;AAAA;;AACA;AACAZ;AACAA;AACAA;AACAA;AACAI;AACA;AACA;;AACA;AACA;;AACA;AACA,SAHA,MAGA;AACA;AACA;;AACA;AACA,OAVA;AAWA;AAjGA,GA5FA;AA+LAS,SA/LA,qBA+LA;AACA;AACA;AACA;AAlMA","names":["name","components","CommonTag","CommonTable","CommonForm","data","isShow","tags","tableData","tableLabel","prop","label","width","formLabel","model","type","operateForm","status","username","operateFormLabel","opts","value","searchForm","keyword","methods","editUser","row","delUser","param","confirmButtonText","cancelButtonText","then","getUser","catch","getTagsList","getUserList","clickMenu","item","getList","confirm","reset","created"],"sourceRoot":"views/user","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1 class=\"title\">用户类别:</h1>\r\n    <common-tag :tags=\"tags\" @clickMenu=\"clickMenu\"></common-tag>\r\n    <el-dialog title=\"修改用户信息\" :visible.sync=\"isShow\">\r\n      <common-form\r\n        :formLabel=\"operateFormLabel\"\r\n        :form=\"operateForm\"\r\n        :inline=\"true\"\r\n        ref=\"form\"\r\n      />\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n         <el-button type=\"danger\" @click=\"reset\">重置密码</el-button>\r\n        <el-button @click=\"isShow = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirm\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n    <div class=\"manage-header\">\r\n      <common-form\r\n        :formLabel=\"formLabel\"\r\n        :form=\"searchForm\"\r\n        :inline=\"true\"\r\n        ref=\"form\"\r\n      >\r\n        <el-button type=\"primary\" @click=\"getList(searchForm.keyword)\"\r\n          >搜索</el-button\r\n        >\r\n      </common-form>\r\n    </div>\r\n    <common-table\r\n      :tableData=\"tableData\"\r\n      :tableLabel=\"tableLabel\"\r\n      @edit=\"editUser\"\r\n      @delete=\"delUser\"\r\n    ></common-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CommonTag from \"../../src/components/CommonTag.vue\";\r\nimport CommonTable from \"../../src/components/CommonTable.vue\";\r\nimport CommonForm from \"../../src/components/CommonForm.vue\";\r\nimport { getUser } from \"../../api/data.js\";\r\n\r\nexport default {\r\n  name: \"User\",\r\n  components: { CommonTag, CommonTable, CommonForm },\r\n  data() {\r\n    return {\r\n      isShow: false,\r\n      tags: [],\r\n      tableData: [],\r\n      tableLabel: [\r\n        {\r\n          prop: \"username\",\r\n          label: \"用户名\",\r\n        },\r\n        {\r\n          prop: \"imgTotal\",\r\n          label: \"图片上传总数\",\r\n        },\r\n        {\r\n          prop: \"type\",\r\n          label: \"用户类型\",\r\n        },\r\n        {\r\n          prop: \"last_login\",\r\n          label: \"最近登录时间\",\r\n          width: 200,\r\n        },\r\n        {\r\n          prop: \"add_date\",\r\n          label: \"用户注册时间\",\r\n          width: 200,\r\n        },\r\n        {\r\n          prop: \"modify_date\",\r\n          label: \"用户信息修改时间\",\r\n          width: 200,\r\n        },\r\n        {\r\n          prop: \"status\",\r\n          label: \"账号状态\",\r\n        },\r\n        {\r\n          prop: \"line\",\r\n          label: \"用户状态\",\r\n        },\r\n      ],\r\n      formLabel: [\r\n        {\r\n          model: \"keyword\",\r\n          label: \"\",\r\n          type: \"input\",\r\n        },\r\n      ],\r\n      operateForm: {\r\n        type: \"\",\r\n        status: \"\",\r\n      },\r\n      username: \"\",\r\n      operateFormLabel: [\r\n        {\r\n          model: \"type\",\r\n          label: \"用户类型\",\r\n          type: \"select\",\r\n          opts: [\r\n            {\r\n              label: \"普通用户\",\r\n              value: \"普通用户\",\r\n            },\r\n            {\r\n              label: \"管理员\",\r\n              value: \"管理员\",\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          model: \"status\",\r\n          label: \"账号状态\",\r\n          type: \"select\",\r\n          opts: [\r\n            {\r\n              label: \"启用\",\r\n              value: \"启用\",\r\n            },\r\n            {\r\n              label: \"停用\",\r\n              value: \"停用\",\r\n            },\r\n          ],\r\n        },\r\n      ],\r\n      searchForm: { keyword: \"\" },\r\n    };\r\n  },\r\n  methods: {\r\n    editUser(row) {\r\n      this.isShow = true;\r\n      this.username = row.username;\r\n      this.operateForm.type = row.type;\r\n      this.operateForm.status = row.status;\r\n    },\r\n    delUser(row) {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"delete_user\");\r\n      param.append(\"username\", row.username);\r\n      this.$confirm(\"此操作将永久删除该用户以及该用户所有的图片,是否继续\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      }).then(() => {\r\n        getUser(param).then((res) => {\r\n          var ret = res.data[\"ret\"];\r\n          var msg = res.data[\"msg\"];\r\n          if (ret === 0) {\r\n            this.$message.success(msg);\r\n          } else {\r\n            this.$message.error(msg);\r\n          }\r\n          this.getUserList();\r\n        });\r\n      }).catch(()=>{});//注意这里，这里是重点！！！;\r\n    },\r\n    getTagsList() {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"get_user_type\");\r\n      getUser(param).then((res) => {\r\n        this.tags = res.data.retlist;\r\n      });\r\n    },\r\n    getUserList() {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"get_user_list\");\r\n      param.append(\"user_type\", \"\");\r\n      param.append(\"username\", \"\");\r\n      getUser(param).then((res) => {\r\n        this.tableData = res.data.retlist;\r\n      });\r\n    },\r\n    clickMenu(item) {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"get_user_list\");\r\n      param.append(\"user_type\", item.value);\r\n      param.append(\"username\", \"\");\r\n      getUser(param).then((res) => {\r\n        this.tableData = res.data.retlist;\r\n      });\r\n    },\r\n    getList(username) {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"get_user_list\");\r\n      param.append(\"user_type\", \"\");\r\n      param.append(\"username\", username);\r\n      getUser(param).then((res) => {\r\n        this.tableData = res.data.retlist;\r\n      });\r\n    },\r\n    confirm() {\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"modify_user\");\r\n      param.append(\"username\", this.username);\r\n      param.append(\"type\", this.operateForm.type);\r\n      param.append(\"status\", this.operateForm.status);\r\n      getUser(param).then((res) => {\r\n        var ret = res.data[\"ret\"];\r\n        var msg = res.data[\"msg\"];\r\n        if (ret === 0) {\r\n          this.$message.success(msg);\r\n           this.isShow = false;\r\n        } else {\r\n          this.$message.error(msg);\r\n        }\r\n        this.getUserList();\r\n      });\r\n    },\r\n    reset(){\r\n      let param = new URLSearchParams();\r\n      param.append(\"action\", \"reset_password\");\r\n      param.append(\"username\", this.username);\r\n      param.append(\"address\", 'user');\r\n      param.append(\"code\", '');\r\n      getUser(param).then((res) => {\r\n        var ret = res.data[\"ret\"];\r\n        var msg = res.data[\"msg\"];\r\n        if (ret === 0) {\r\n          this.$message.success(msg);\r\n          this.isShow=false\r\n        } else {\r\n          this.$message.error(msg);\r\n        }\r\n        this.getUserList();\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.getTagsList();\r\n    this.getUserList();\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n@import \"../../src/assets/less/index.less\";\r\n.manage-header {\r\n  display: flex;\r\n  justify-content: space-between; //左右靠边\r\n  align-items: center; //上下对齐\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}